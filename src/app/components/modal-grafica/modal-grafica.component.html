<div class="modal-backdrop modern-modal-backdrop" (click)="cerrar()">
  <div class="modal-container modern-chart-modal" (click)="$event.stopPropagation()">
    <div class="modal-header chart-config-header">
      <div class="modal-title">
        <mat-icon class="modal-icon">analytics</mat-icon>
        <span>Configurar Gráfica</span>
      </div>
      <button type="button" 
              class="btn-modal-action btn-close-modal"
              matTooltip="Cerrar"
              (click)="cerrar()">
        <mat-icon>close</mat-icon>
      </button>
    </div>

    <div class="modal-content chart-config-content">
      <div class="config-section">
        <!-- Sección Izquierda: Tipo de Gráfica -->
        <div class="chart-type-section">
          <div class="section-header">
            <mat-icon class="section-icon">bar_chart</mat-icon>
            <label class="section-title">Tipo de Gráfica</label>
          </div>
          <div class="chart-type-grid">
            <button type="button" 
                    (click)="tipoGrafica = 'bar'"
                    [class.selected]="tipoGrafica === 'bar'"
                    class="chart-type-btn">
              <mat-icon class="chart-icon">bar_chart</mat-icon>
              <span class="chart-label">Barras</span>
            </button>
            <button type="button" 
                    (click)="tipoGrafica = 'line'"
                    [class.selected]="tipoGrafica === 'line'"
                    class="chart-type-btn">
              <mat-icon class="chart-icon">show_chart</mat-icon>
              <span class="chart-label">Líneas</span>
            </button>
            <button type="button" 
                    (click)="tipoGrafica = 'pie'"
                    [class.selected]="tipoGrafica === 'pie'"
                    class="chart-type-btn">
              <mat-icon class="chart-icon">pie_chart</mat-icon>
              <span class="chart-label">Circular</span>
            </button>
            <button type="button" 
                    (click)="tipoGrafica = 'radar'"
                    [class.selected]="tipoGrafica === 'radar'"
                    class="chart-type-btn">
              <mat-icon class="chart-icon">radar</mat-icon>
              <span class="chart-label">Radar</span>
            </button>
          </div>
        </div>

        <!-- Sección Derecha: Selección de Columnas -->
        <div class="columns-section">
          <div class="section-header">
            <mat-icon class="section-icon">view_column</mat-icon>
            <label class="section-title">
              Columnas de Datos
              <span class="section-subtitle">(seleccione al menos 2)</span>
            </label>
          </div>
          <div class="columns-container">
            <div class="columns-list">
              <div *ngFor="let header of headers; let i = index"
                   class="column-item"
                   [class.selected]="isColumnSelected(i)"
                   (click)="toggleColumna(i)">
                <div class="column-checkbox">
                  <mat-icon *ngIf="isColumnSelected(i)" class="check-icon">check</mat-icon>
                </div>
                <div class="column-info">
                  <span class="column-name">{{header}}</span>
                  <span class="column-type">{{getColumnType(i)}}</span>
                </div>
                <mat-icon class="column-icon">{{getColumnIcon(i)}}</mat-icon>
              </div>
            </div>
            <div class="columns-summary">
              <div class="summary-item">
                <mat-icon class="summary-icon">check_circle</mat-icon>
                <span class="summary-text">{{columnasSeleccionadas.length}} columnas seleccionadas</span>
              </div>
              <div class="summary-item" *ngIf="columnasSeleccionadas.length >= 2">
                <mat-icon class="summary-icon success">verified</mat-icon>
                <span class="summary-text success">Listo para crear gráfica</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Botones -->
    <div class="modal-footer">
      <button type="button" 
              (click)="cerrar()"
              class="btn-secondary">
        <mat-icon>close</mat-icon>
        Cancelar
      </button>
      <button type="button" 
              (click)="crearGrafica()"
              [disabled]="columnasSeleccionadas.length < 2"
              class="btn-primary"
              [class.disabled]="columnasSeleccionadas.length < 2">
        <mat-icon>add_chart</mat-icon>
        Crear Gráfica
      </button>
    </div>
  </div>
</div>
